<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Book</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1 class="title">Add New Book</h1>
        <form action="http://localhost:3000/book" method="post" class="productInfo">
            <input type="text" name="Code" class="field" id="pId" placeholder="Id">
        
            <input type="text" name="Name" class="field" id="pName" placeholder="Name">
        
            <input type="text" name="Price" class="field" id="pPrice" placeholder="Price">
        
            <input type="text" name="Quantity" class="field" id="pQuantity" placeholder="Quantity">
            
            <button type="submit" class="createBtn">Create</button>
        </form>
        <a href="./home.html" class="backBtn">Back</a>


        <script>
           let barcode = '';
           let timer = null;
           let lastKeyTime = Date.now();
           let input = document.getElementById('pId');
            

           input.addEventListener('keydown' , (event) => {
                if (event.key === 'Enter') {
                    event.preventDefault();
                }
                if(event.key.length > 1 && event.key !== 'Enter')
                    return;
                const currentTime = Date.now();
                const timeDiff = currentTime - lastKeyTime;
                lastKeyTime = currentTime;

                if(timeDiff > 100){
                    barcode = '';
                }

                if(event.key === 'Enter'){
                    if(barcode.length > 0){
                        input.value = barcode;
                        input.readOnly=true;
                        input.style.width = "75%";
                    }
                    barcode = '';
                    return;
                }

                barcode += event.key;

                clearTimeout(timer);
                timer = setTimeout(()=> {
                    barcode = '';
                },300);
           });
        </script>
    </div>
</body>
</html>